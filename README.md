Sorry for code style, I write this using vi text editor
